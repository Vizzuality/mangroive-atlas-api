<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <title>Site Report</title>
  </head>
  <body>
    
    <% @single_site.each do |site_row| %>
      <h1 class="heading-invisible"><%= @pdf_landscape %> - <%= site_row['site_name'] %></h1>
      <h2 class="font-heading">
        Landscape: <%= @pdf_landscape %><br>
        Site: <%= site_row['site_name'] %>
      </h2>
    <% end %>

    <!-- Start of Registration Answers -->
    <h3 class="heading-invisible">REGISTRATION / INTERVENTION</h3>
    <% @pdf_reg_answers.each do |category, questions| %>
      <h2><%= category %></h2>
      <% questions.each do |key, item| %>
        <hr class="no-margin">
        <div class= "<%= cycle('white', 'mint') -%> question-padding">
          <table>   
            <tr class="question-row-alignment">
              <td class="question-number"><%= key %></td>          
              <td><b><%= item[:name] %></b></td>
            </tr>
            <% if item[:value].is_a?(String) -%>
              <tr>
                <td></td>
                <td><%= item[:value] -%></td>
              </tr>
            <% elsif item[:value].is_a?(Array) -%>
              <tr>
                <td></td>
                <td>
                  <table class="answers-table">
                    <% item[:value].each do |x| %>
                      <% if x.class == Hash -%>
                        <tr>
                          <td>&bull;</td>
                          <% x.each do |key, value| -%>
                            <td>
                              <b><%= key.capitalize -%>:</b> <%= value -%>
                            </td>
                          <% end -%>
                        </tr>
                      <%  elsif x.class == String &&  x.start_with?("#{Rails.root}/tmp/") -%>
                        <img src="<%= x -%>" alt="site boundary"/>
                      <% else -%>
                        <li><%= x %></li>
                      <% end -%>
                    <% end %>
                  </table>
                </td>
              </tr>
            <% end -%>
          </table>
        </div>
      <% end %>
      <div class="pagebreak"> </div>
    <% end %>

    <!-- Start of Monitoring Answers -->

    <% @pdf_mon_answers.each do |uuid, values| %>      
      <h2><%= values["category"] %></h2>
      <h2>Date of Entry: <%= values["monitoring_date"] %></h2>
      <h3 class="heading-invisible">MONITORING</h3>
      <% values["answers"].each do |key, item| %>
        <hr class="no-margin">
        <div class= "<%= cycle('white', 'mint') -%> question-padding">
          <table>   
            <tr class="question-row-alignment">
              <td class="question-number"><%= key %></td>          
              <td><b><%= item[:name] %></b></td>
            </tr>
            <% if item[:value].is_a?(String) -%>
              <tr>
                <td></td>
                <td><%= item[:value] -%></td>
              </tr>
            <% elsif item[:value].is_a?(Array) -%>
              <tr>
                <td></td>
                <td>
                  <table class="answers-table">
                    <% item[:value].each do |x| %>
                      <% if x.class == Hash -%>
                        <tr>
                          <td>&bull;</td>
                          <% x.each do |key, value| -%>
                            <td>
                              <b><%= key.capitalize -%>:</b> <%= value -%>
                            </td>
                          <% end -%>
                        </tr>
                      <% else -%>
                        <li><%= x %></li>
                      <% end -%>
                    <% end %>
                  </table>
                </td>
              </tr>
            <% end -%>
          </table>
        </div>
      <% end %>
      <div class="pagebreak"> </div>
    <% end %>  
    
  
  </body>
</html>
